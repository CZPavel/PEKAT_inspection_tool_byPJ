# Tuning Catalog Format (v3.4)

This file describes the Script Catalog data layout used by `Pekat Tuning`.

## Storage tree

```text
resources/code_modules/
  scripts_raw/
  scripts_utf8/
  pmodule/
  catalog.json
  categories.json
```

## `catalog.json` schema

Top-level:
- `schema_version`
- `generated_at`
- `items` (array)

Each item fields:
- `id`
- `name`
- `source_filename`
- `storage_path_utf8`
- `storage_path_raw`
- `format` (`txt|py|pmodule`)
- `category`
- `tags`
- `short_description`
- `encoding_source`
- `size_bytes`
- `sha256`
- `created_at`
- `updated_at`
- `empty`
- `purpose` (`K cemu slouzi`)
- `what_it_does` (`Co dela`)
- `context_keys` (`Klicove context`)
- `dependencies` (`Zavislosti`)
- `description_source` (`xlsx|txt|generated`)

## Import rules
- Accept `.txt`, `.py`, `.pmodule`.
- Text decode order:
  1) `utf-8-sig`
  2) `utf-8`
  3) `cp1250`
  4) `latin1`
- Canonical UTF-8 copy is used for preview and clipboard copy.
- Raw source is preserved for traceability.
- Import is destructive replace, not append.
- Replace sync removes old content in:
  - `scripts_raw/*`
  - `scripts_utf8/*`
  - `pmodule/*`
- Metadata is loaded from source folder files:
  - `Prehled scriptu pro PEKAT CODE modul.xlsx` (primary)
  - `Popis funkcionalit a urceni scriptu.txt` (supplement)
- Missing metadata is generated by fallback heuristics.
- Empty script files are skipped when `skip_empty=true`.
- `PYZBAR_BARCODE_READER.txt` is intentionally excluded because source file is empty.

## Categories

`categories.json` follows XLSX categories used by the new base set:
- `Flow control`
- `Zprac. obrazu`
- `Detekce`
- `Ukladani`
- `Ukladani/overlay`
- `Mereni`
- `Geometrie`
- `IO-Link`
